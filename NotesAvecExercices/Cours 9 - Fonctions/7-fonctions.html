<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cours JavaScript - Fonctions</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../editor/editor.css">
</head>

<body>

    <header class="mobile-header">
        <button id="menu-btn" aria-label="Menu"><i data-lucide="menu"></i></button>
        <span class="logo">JS 06</span>
    </header>

    <div class="app-container">

        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <span class="js-badge">JS</span>
                <h1>Fonctions</h1>
            </div>
            <nav class="sidebar-nav">
                <a href="../../index.html" class="nav-link">Retour</a>
            </nav>
        </aside>

        <main class="main-content">

            <section class="section-spy">
                <h2 class="section-title">Introduction</h2>
                <p>
                    Une fonction est un <strong>bloc de code réutilisable</strong>. On la définit une fois, et on l'appelle
                    autant de fois que nécessaire. C'est l'outil principal pour éviter la répétition et structurer un programme.
                </p>
                <div class="info-box info">
                    <strong>Idée clé :</strong> une fonction = une action précise, avec un nom clair.
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Déclarer une fonction</h3>
                </div>
                <p>Voici la forme classique d'une fonction en JavaScript :</p>
                <div class="playground-container" data-type="example" data-title="Exemple : saluer()">
                    <textarea class="source-code" hidden>
function saluer() {
  console.log("Bonjour !");
}

saluer();
saluer();
</textarea>
                </div>
                <div class="info-box tip">
                    <h4><i data-lucide="sparkles"></i>Bon réflexe</h4>
                    <p>Un nom de fonction doit commencer par un verbe : <code>afficherScore</code>, <code>calculerTotal</code>, etc.</p>
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Paramètres & Arguments</h3>
                </div>
                <p>
                    Les <strong>paramètres</strong> sont les variables entre parenthèses. Les <strong>arguments</strong> sont les valeurs
                    passées quand on appelle la fonction.
                </p>
                <div class="playground-container" data-type="example" data-title="Exemple : saluer(nom)">
                    <textarea class="source-code" hidden>
function saluer(nom) {
  console.log(`Salut, ${nom} !`);
}

saluer("Ada");
saluer("Linus");
</textarea>
                </div>

                <div class="playground-container" 
                     data-type="exercise" 
                     data-title="Exercice : présenter un joueur" 
                     data-instructions="Complète la fonction pour afficher 'Le joueur X a Y points'."
                     data-auto-height="false">
                    <textarea class="source-code" hidden>
function presenterJoueur(nom, points) {
  // Affiche : "Le joueur NOM a POINTS points"
}

presenterJoueur("Maya", 120);
</textarea>
                    <textarea class="solution-code" hidden>
function presenterJoueur(nom, points) {
  console.log("Le joueur " + nom + " a " + points + " points");
}

presenterJoueur("Maya", 120);
</textarea>
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Retourner une valeur</h3>
                </div>
                <p>
                    Une fonction peut <strong>retourner</strong> une valeur grâce à <code>return</code>. Cela permet de réutiliser
                    le résultat ailleurs.
                </p>
                <div class="playground-container" data-type="example" data-title="Exemple : addition()">
                    <textarea class="source-code" hidden>
function addition(a, b) {
  return a + b;
}

let resultat = addition(5, 7);
console.log("Résultat :", resultat);
</textarea>
                </div>
                <div class="playground-container"
                     data-type="exercise"
                     data-title="Exercice : retour de valeur (TPS)"
                     data-instructions="Complète la fonction pour qu'elle retourne 5% du montant."
                     data-auto-height="false">
                    <textarea class="source-code" hidden>
function calculerTPS(montant) {
  // Retourne 5% du montant
}

let tps = calculerTPS(200);
console.log("TPS :", tps);
console.log("Total :", 200 + tps);
</textarea>
                    <textarea class="solution-code" hidden>
function calculerTPS(montant) {
  return montant * 0.05;
}

let tps = calculerTPS(200);
console.log("TPS :", tps);
console.log("Total :", 200 + tps);
</textarea>
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Portée des variables</h3>
                </div>
                <p>
                    Une variable déclarée dans une fonction n'existe <strong>que dans cette fonction</strong>.
                    On parle de portée (scope).
                </p>
                <div class="playground-container" data-type="example" data-title="Exemple : portée locale">
                    <textarea class="source-code" hidden>
let score = 10;

function ajouterBonus() {
  let bonus = 5;
  score = score + bonus;
}

ajouterBonus();
console.log("Score :", score);
</textarea>
                </div>
                <div class="info-box info">
                    <strong>Important :</strong> La variable <code>bonus</code> n'existe pas en dehors de la fonction.
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Fonctions fléchées</h3>
                </div>
                <p>
                    Les fonctions fléchées sont une syntaxe plus courte pour écrire des fonctions.
                </p>
                <div class="playground-container" data-type="example" data-title="Exemple : doubler()">
                    <textarea class="source-code" hidden>
const doubler = (n) => {
  return n * 2;
};

console.log(doubler(6));
</textarea>
                </div>
                <div class="playground-container"
                     data-type="exercise"
                     data-title="Exercice : fonction fléchée estPair"
                     data-instructions="Complète la fonction fléchée pour retourner true si le nombre est pair, sinon false."
                     data-auto-height="false">
                    <textarea class="source-code" hidden>
const estPair = (nombre) => {
  // Retourne true si nombre est pair, sinon false
};

console.log(estPair(8));
console.log(estPair(7));
</textarea>
                    <textarea class="solution-code" hidden>
const estPair = (nombre) => {
  return nombre % 2 === 0;
};

console.log(estPair(8));
console.log(estPair(7));
</textarea>
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Erreurs fréquentes</h3>
                </div>
                <div class="info-box error">
                    <h4><i data-lucide="x-circle"></i> Oublier les parenthèses</h4>
                    <p>Écrire <code>maFonction</code> n'appelle pas la fonction. Il faut <code>maFonction()</code>.</p>
                </div>
                <div class="info-box error">
                    <h4><i data-lucide="alert-triangle"></i> Confondre afficher et retourner</h4>
                    <p>
                        <code>console.log()</code> affiche, mais ne renvoie pas de valeur. Pour renvoyer, utilisez <code>return</code>.
                    </p>
                </div>
                <div class="playground-container" data-type="example" data-title="Exemple : return vs console.log">
                    <textarea class="source-code" hidden>
function carre(n) {
  console.log(n * n); // Affiche mais ne renvoie rien
}

function carreAvecRetour(n) {
  return n * n;
}

let a = carre(4);
let b = carreAvecRetour(4);
console.log("a :", a);
console.log("b :", b);
</textarea>
                </div>
            </section>

            <section class="section-spy">
                <div class="section-header">
                    <h3>Défi final : tableau + boucle + fonction + HTML</h3>
                </div>
                <p>
                    Objectif: créer une fonction qui fabrique un élément HTML, puis l'utiliser dans une boucle
                    <code>for</code> pour afficher une liste complète.
                </p>
                <div class="playground-container"
                     data-type="exercise"
                     data-title="Exercice : générer des cartes depuis un tableau"
                     data-instructions="Crée une fonction qui retourne un élément HTML, puis ajoute une carte par fruit."
                     data-auto-height="false">
                    <textarea class="source-code" hidden>
const fruits = ["Pomme", "Banane", "Kiwi", "Mangue"];

let zone = document.getElementById("zone-fruits");
if (!zone) {
  zone = document.createElement("section");
  zone.id = "zone-fruits";
  zone.style.marginTop = "12px";
  zone.style.display = "grid";
  zone.style.gap = "6px";
  document.body.appendChild(zone);
}
zone.innerHTML = "";

function creerCarteFruit(nom, index) {
  // 1. Crée un <article>
  // 2. Mets le texte: "index. nom"
  // 3. Retourne l'élément
}

// 4. Parcours fruits avec for
// 5. Appelle creerCarteFruit(...) puis ajoute la carte dans zone
// 6. Affiche en console le nombre de cartes créées
</textarea>
                    <textarea class="solution-code" hidden>
const fruits = ["Pomme", "Banane", "Kiwi", "Mangue"];

let zone = document.getElementById("zone-fruits");
if (!zone) {
  zone = document.createElement("section");
  zone.id = "zone-fruits";
  zone.style.marginTop = "12px";
  zone.style.display = "grid";
  zone.style.gap = "6px";
  document.body.appendChild(zone);
}
zone.innerHTML = "";

function creerCarteFruit(nom, index) {
  const card = document.createElement("article");
  card.style.border = "1px solid #334155";
  card.style.borderRadius = "8px";
  card.style.padding = "8px 10px";
  card.style.background = "#0f172a";
  card.style.color = "#e2e8f0";
  card.innerText = `${index + 1}. ${nom}`;
  return card;
}

for (let i = 0; i < fruits.length; i++) {
  const carte = creerCarteFruit(fruits[i], i);
  zone.appendChild(carte);
}

console.log("Cartes créées :", zone.children.length);
</textarea>
                </div>
            </section>
        </main>
    </div>

    <script src="../editor/editor.js"></script>
    <script src="../scripts/script.js"></script>
</body>

</html>
